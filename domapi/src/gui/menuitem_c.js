// Copyright 2001-2003, Nebiru Software
// www.domapi.com
core.registerComponent("menuitem");function Menuitem(arg){var p=arg["parent"];var e=document.createElement(p.domAPIObjType=="MENUBAR"?"SPAN":"DIV");e.innerHTML=arg["caption"];e.enabled=true;e.fn=arg["fn"];e.dropDown=null;core._inherit(e,"menuitem");with(e.style){padding="3px 5px";cursor="default";whiteSpace="nowrap";position="relative";top="2px"}if(p.domAPIObjType=="MENUBAR"){var t=p.theme;var s=e.style;s.borderWidth=t.bdrWidth+"px";s.borderStyle=t.bdrSolid;s.borderColor=t.getOutset()}e.domAPIObjType="MENUITEM";return e};core.comps.menuitem.onclick=function(e){if(this.dropDown)this.dropDown.hide();if(!this.enabled)return;var temp=this.parentNode;while(temp){if(temp.domAPIObjType)if(temp.domAPIObjType=="MENUBAR")break;else if(temp.domAPIObjType=="MENU"){temp.hide();temp.onselect(this)}if(temp.parentElm)temp=temp.parentElm;else temp=temp.parentNode}var p;temp=core.findTarget(e,"MENU");while(temp){if(!temp.parentElm)break;temp=temp.parentElm;if(temp)p=core.findParent(temp,"MENU");if(!p)if(core.findParent(temp,"MENUBAR")){temp=core.findParent(temp,"MENUBAR");break}temp=p}if(temp&&typeof temp.hideAllMenus=="function")temp.hideAllMenus();var typ=typeof this.fn;if(typ!="undefined"){if(typ=="function")this.fn();else eval(this.fn)}};core.comps.menuitem.addItem=function(caption,fn){if(!this.dropDown){if(core.findParent(this,"MENU")){this.cascadeIcon=document.createElement("SPAN");this.cascadeIcon.innerHTML=core.comps.menu.chevron;this.cascadeIcon.style.position="absolute";this.cascadeIcon.style.left=this.offsetWidth-12+"px";this.cascadeIcon.style.top="2px";this.appendChild(this.cascadeIcon)}this.dropDown=Menu({theme:this.parentNode.theme,desiredW:this.dw,shadowW:this.shadowW});this.dropDown.parentElm=this;this.dropDown.setPosition("absolute");this.dropDown.moveTo(0,0);this.dropDown.hide()}this.dropDown.addItem(caption,fn)};core.comps.menuitem.addSeparator=function(s){if(!this.dropDown){this.dropDown=Menu({theme:this.parentNode.theme,desiredW:this.dw,shadowW:this.shadowW});this.dropDown.setPosition("absolute");this.dropDown.moveTo(0,0);this.dropDown.hide()}this.dropDown.addSeparator(s)};core.comps.menuitem.setEnabled=function(b){var t=core.findParent(this,"MENU");if(!t)t=core.findParent(this,"MENUBAR");if(!t)return;t=t.theme;this.enabled=b;this.style.color=b?t.ctrlFgColor:t.bdrDark;var tds=this.getElementsByTagName("TD");for(var b in tds)if(tds[b].style)tds[b].style.color=this.style.color};
