// Copyright 2001-2003, Nebiru Software
// www.domapi.com
core.loadUnit("color");core.loadUnit("button");core.loadUnit("dropdown");core.loadUnit("slider2");core.registerComponent("colorpicker");core.colorpickerShared={};core.colorpickerShared.sliderBG=["5","95"];core.colorpickerShared.sliderFG=["18","9"];function Colorpicker(arg){arg.w=150;arg.h=22;var e=core._component(arg,"colorpicker",true);core._inherit(e,"dropdown");var pathToButtons=arg["pathToButtons"];e._constructor(pathToButtons);core._inherit(e,"colorpicker");e.value=core.rVal(arg["c"],"#FFFFFF");e.pathToButtons=core.rVal(pathToButtons,core.imagePath+"buttons/");e.kind=core.rInt(arg["kind"]);e.edit.value=e.value;e.wheel0=core.createElm(e.dropDown,0,0);e.wheel1=core.createElm(e.dropDown,0,0,180,200);e.wheel0.setText(core.colorpickerShared.wheels[0]);e.composite=core.createElm(e.wheel1,10,130,110,30,"white");with(e.composite){style.cursor=core.cursors.hand;title=core.getString("COLORPICKER_SELECT")}var bi=core.imagePath+"sliders/colorpicker/";var ti=bi+"thumb1.gif";e.sliderR=Slider2({parent:e.wheel1,x:10,y:10,w:39,h:95,tw:19,th:9,bgImg:bi+"red1.gif",thumbImg:ti});e.sliderG=Slider2({parent:e.wheel1,x:50,y:10,w:39,h:95,tw:19,th:9,bgImg:bi+"green1.gif",thumbImg:ti});e.sliderB=Slider2({parent:e.wheel1,x:90,y:10,w:39,h:95,tw:19,th:9,bgImg:bi+"blue1.gif",thumbImg:ti});e.sliderW=Slider2({parent:e.wheel1,x:150,y:10,w:39,h:95,tw:19,th:9,bgImg:bi+"white1.gif",thumbImg:ti});var t=core.colorpickerShared.sliderBG;e.sliderR.bgImage.width=t[0];e.sliderR.bgImage.height=t[1];e.sliderG.bgImage.width=t[0];e.sliderG.bgImage.height=t[1];e.sliderB.bgImage.width=t[0];e.sliderB.bgImage.height=t[1];e.sliderW.bgImage.width=t[0];e.sliderW.bgImage.height=t[1];t=core.colorpickerShared.sliderFG;e.sliderR.thumb.img.width=t[0];e.sliderR.thumb.img.height=t[1];e.sliderG.thumb.img.width=t[0];e.sliderG.thumb.img.height=t[1];e.sliderB.thumb.img.width=t[0];e.sliderB.thumb.img.height=t[1];e.sliderW.thumb.img.width=t[0];e.sliderW.thumb.img.height=t[1];e.sliderR.setRange(5,0,5,86);e.sliderR.thumb.style.cursor=core.cursors.hand;e.sliderR.k="r";e.sliderG.setRange(5,0,5,86);e.sliderG.thumb.style.cursor=core.cursors.hand;e.sliderG.k="g";e.sliderB.setRange(5,0,5,86);e.sliderB.thumb.style.cursor=core.cursors.hand;e.sliderB.k="b";e.sliderW.setRange(5,0,5,86);e.sliderW.thumb.style.cursor=core.cursors.hand;e.sliderW.setPos(0,50);e.sliderW.old=50;e.sliderRSwatch=core.createElm(e.wheel1,10,110,30,15,"black","white");e.sliderRSwatch.style.textAlign="center";e.sliderGSwatch=core.createElm(e.wheel1,50,110,30,15,"black","white");e.sliderGSwatch.style.textAlign="center";e.sliderBSwatch=core.createElm(e.wheel1,90,110,30,15,"black","white");e.sliderBSwatch.style.textAlign="center";e.sliderR.p=e;e.sliderR.reversed=true;e.sliderR.value="FF";e.sliderR.valuei=255;e.sliderRSwatch.setText("FF");e.sliderG.p=e;e.sliderG.reversed=true;e.sliderG.value="FF";e.sliderG.valuei=255;e.sliderGSwatch.setText("FF");e.sliderB.p=e;e.sliderB.reversed=true;e.sliderB.value="FF";e.sliderB.valuei=255;e.sliderBSwatch.setText("FF");e.sliderW.p=e;e.sliderW.reversed=true;e.dropDown.colorStr=core.createElm(e.dropDown,0,0);e.dropDown.colorStr.style.textAlign="center";with(e.dropDown.colorStr){moveTo(2,205);setSize(176,18);setB(1);style.borderColor="black";style.borderStyle="solid";setBgColor(e.theme.bgColor);style.font="10pt 'courier new',monospace"}e.pRadio1=Button({parent:e.dropDown,x:7,y:230,w:80,h:18,caption:core.getString("COLORPICKER_SAFE")});e.pRadio2=Button({parent:e.dropDown,x:93,y:230,w:80,h:18,caption:core.getString("COLORPICKER_CUSTOM")});e.pRadio1.tag=0;e.pRadio2.tag=1;var t=core.colorpickerShared;e.edit.onchange=t._oneditchange;e.edit.onkeyup=t._oneditkeyup;e.sliderW.onchange=t._onwchange;e.sliderR.onchange=t._onsliderchange;e.sliderG.onchange=t._onsliderchange;e.sliderB.onchange=t._onsliderchange;e.wheel0.childNodes[0].onmouseover=t._wheelonmouseover;e.wheel0.childNodes[0].onmouseout=t._wheelonmouseout;e.wheel0.childNodes[0].onclick=t._wheelonclick;e.pRadio1.onclick=t._switchKind;e.pRadio2.onclick=t._switchKind;e.composite.onclick=t._swatchonclick;e.reDraw();return e};core.comps.colorpicker.reDraw=function(){this.dropBtn.style.left=this.getW()-20+"px";this.pRadio1.theme=this.theme;this.pRadio2.theme=this.theme;this.pRadio1.reDraw();this.pRadio2.reDraw();switch(this.kind){case 0:this.wheel0.style.display="block";this.wheel1.style.display="none";break;case 1:this.wheel0.style.display="none";this.wheel1.style.display="block";break}this.dropDown.style.backgroundColor=this.theme.bgColor;this.edit.value=this.value;this.edit.setBgColor(this.value);this.edit.setColor((core.color.mergeColor(this.value,"","floor")));this.dropDown.setSize(182,255)};core.colorpickerShared._switchKind=function(){this.parentNode.parent.kind=this.tag;this.parentNode.parent.reDraw()};core.colorpickerShared._oneditchange=function(){var p=this.parentNode;if(p.onbeforechange(this.value)){p.value=this.value;p._onchange();p.reDraw()}else this.value=p.value};core.colorpickerShared._oneditkeyup=function(){if(this.value.length==7){var p=this.parentNode;if(p.onbeforechange(this.value)){p.value=this.value;p._onchange();p.reDraw()}else this.value=p.value}};core.colorpickerShared._onsliderchange=function(xp,yp){this.value=core.colorpickerShared.lu[yp];this.valuei=yp;switch(this.k){case "r":var c=this.value+"0000";var swatch=this.p.sliderRSwatch;break;case "g":var c="00"+this.value+"00";var swatch=this.p.sliderGSwatch;break;case "b":var c="0000"+this.value;var swatch=this.p.sliderBSwatch}swatch.setBgColor(c);swatch.setText(this.value);this.p.dropDown.colorStr.setText(this.p.sliderR.value+this.p.sliderG.value+this.p.sliderB.value);this.p.composite.setBgColor(this.p.dropDown.colorStr.innerHTML)};core.colorpickerShared._onwchange=function(xp,yp){var delta=yp-this.old;var r=this.p.sliderR;var rp=r.valuei+delta;if(rp<0)return;if(rp>100)return;var g=this.p.sliderG;var gp=g.valuei+delta;if(gp<0)return;if(gp>100)return;var b=this.p.sliderB;var bp=b.valuei+delta;if(bp<0)return;if(bp>100)return;r.setPos(0,rp,true);g.setPos(0,gp,true);b.setPos(0,bp,true);this.old=yp};core.colorpickerShared._wheelonmouseover=function(e){core.preventBubble(e);var temp=core.findTarget(e,"TD");if(!temp)return;var root=core.findParent(temp,"DROPPANEL");if(!root)return;root.colorStr.setText(temp.getAttribute("bgcolor")+" "+temp.title)};core.colorpickerShared._wheelonmouseout=function(e){core.preventBubble(e);var temp=core.findTarget(e,"TD");if(!temp)return;var root=core.findParent(temp,"DROPPANEL");if(!root)return;root.colorStr.innerHTML=""};core.colorpickerShared._wheelonclick=function(e){core.preventBubble(e);var temp=core.findTarget(e,"TD");if(!temp)return;var root=core.findParent(temp,"DROPPANEL");if(!root)return;var c=core.color.makeSureIsHexColor(temp.getAttribute("bgcolor")).toUpperCase();var p=root.parent;if(p.onbeforechange(c)){p.value=c;p.reDraw();if(p.autoClose)p.dropBtn.onclick();p._onchange()}};core.colorpickerShared._swatchonclick=function(e){core.preventBubble(e);var root=core.findParent(this,"DROPPANEL");if(!root)return;var c=core.color.makeSureIsHexColor(this.style.backgroundColor).toUpperCase();var p=root.parent;if(p.onbeforechange(c)){p.value=c;p.reDraw();if(p.autoClose)p.dropBtn.onclick();p._onchange()}};document.writeln("<style>.colorTable{cursor:default;border:1px outset gray;border-width:0px 2px 2px 0px;position:relative;width:180px;height:200px}.colorTable td{border-style:solid;border-width:2px 0px 0px 2px;border-color:silver gray gray;font-size:1pt;position:relative;cursor:pointer}</style>");core.colorpickerShared.wheels=[ '<table class=colorTable cols=18 row=15 cellpadding=0 cellspacing=0 border=0><tr><td bgcolor="#000000" title=black>&nbsp;</td><td bgcolor="#000033">&nbsp;</td><td bgcolor="#000066">&nbsp;</td><td bgcolor="#000099">&nbsp;</td><td bgcolor="#0000CC">&nbsp;</td><td bgcolor="#0000FF" title=blue>&nbsp;</td><td bgcolor="#330000">&nbsp;</td><td bgcolor="#330033">&nbsp;</td><td bgcolor="#330066">&nbsp;</td><td bgcolor="#330099">&nbsp;</td><td bgcolor="#3300CC">&nbsp;</td><td bgcolor="#3300FF">&nbsp;</td><td bgcolor="#660000">&nbsp;</td><td bgcolor="#660033">&nbsp;</td><td bgcolor="#660066">&nbsp;</td><td bgcolor="#660099">&nbsp;</td><td bgcolor="#6600CC">&nbsp;</td><td bgcolor="#6600FF">&nbsp;</td></tr><tr><td bgcolor="#990000">&nbsp;</td><td bgcolor="#990033">&nbsp;</td><td bgcolor="#990066">&nbsp;</td><td bgcolor="#990099">&nbsp;</td><td bgcolor="#9900CC">&nbsp;</td><td bgcolor="#9900FF">&nbsp;</td><td bgcolor="#CC0000">&nbsp;</td><td bgcolor="#CC0033">&nbsp;</td><td bgcolor="#CC0066">&nbsp;</td><td bgcolor="#CC0099">&nbsp;</td><td bgcolor="#CC00CC">&nbsp;</td><td bgcolor="#CC00FF">&nbsp;</td><td bgcolor="#FF0000" title=red>&nbsp;</td><td bgcolor="#FF0033">&nbsp;</td><td bgcolor="#FF0066">&nbsp;</td><td bgcolor="#FF0099">&nbsp;</td><td bgcolor="#FF00CC">&nbsp;</td><td bgcolor="#FF00FF" title=fuchsia>&nbsp;</td></tr><tr><td bgcolor="#003300">&nbsp;</td><td bgcolor="#003333">&nbsp;</td><td bgcolor="#003366">&nbsp;</td><td bgcolor="#003399">&nbsp;</td><td bgcolor="#0033CC">&nbsp;</td><td bgcolor="#0033FF">&nbsp;</td><td bgcolor="#333300">&nbsp;</td><td bgcolor="#333333">&nbsp;</td><td bgcolor="#333366">&nbsp;</td><td bgcolor="#333399">&nbsp;</td><td bgcolor="#3333CC">&nbsp;</td><td bgcolor="#3333FF">&nbsp;</td><td bgcolor="#663300">&nbsp;</td><td bgcolor="#663333">&nbsp;</td><td bgcolor="#663366">&nbsp;</td><td bgcolor="#663399">&nbsp;</td><td bgcolor="#6633CC">&nbsp;</td><td bgcolor="#6633FF">&nbsp;</td></tr><tr><td bgcolor="#993300">&nbsp;</td><td bgcolor="#993333">&nbsp;</td><td bgcolor="#993366">&nbsp;</td><td bgcolor="#993399">&nbsp;</td><td bgcolor="#9933CC">&nbsp;</td><td bgcolor="#9933FF">&nbsp;</td><td bgcolor="#CC3300">&nbsp;</td><td bgcolor="#CC3333">&nbsp;</td><td bgcolor="#CC3366">&nbsp;</td><td bgcolor="#CC3399">&nbsp;</td><td bgcolor="#CC33CC">&nbsp;</td><td bgcolor="#CC33FF">&nbsp;</td><td bgcolor="#FF3300">&nbsp;</td><td bgcolor="#FF3333">&nbsp;</td><td bgcolor="#FF3366">&nbsp;</td><td bgcolor="#FF3399">&nbsp;</td><td bgcolor="#FF33CC">&nbsp;</td><td bgcolor="#FF33FF">&nbsp;</td></tr><tr><td bgcolor="#006600">&nbsp;</td><td bgcolor="#006633">&nbsp;</td><td bgcolor="#006666">&nbsp;</td><td bgcolor="#006699">&nbsp;</td><td bgcolor="#0066CC">&nbsp;</td><td bgcolor="#0066FF">&nbsp;</td><td bgcolor="#336600">&nbsp;</td><td bgcolor="#336633">&nbsp;</td><td bgcolor="#336666">&nbsp;</td><td bgcolor="#336699">&nbsp;</td><td bgcolor="#3366CC">&nbsp;</td><td bgcolor="#3366FF">&nbsp;</td><td bgcolor="#666600">&nbsp;</td><td bgcolor="#666633">&nbsp;</td><td bgcolor="#666666">&nbsp;</td><td bgcolor="#666699">&nbsp;</td><td bgcolor="#6666CC">&nbsp;</td><td bgcolor="#6666FF">&nbsp;</td></tr><tr><td bgcolor="#996600">&nbsp;</td><td bgcolor="#996633">&nbsp;</td><td bgcolor="#996666">&nbsp;</td><td bgcolor="#996699">&nbsp;</td><td bgcolor="#9966CC">&nbsp;</td><td bgcolor="#9966FF">&nbsp;</td><td bgcolor="#CC6600">&nbsp;</td><td bgcolor="#CC6633">&nbsp;</td><td bgcolor="#CC6666">&nbsp;</td><td bgcolor="#CC6699">&nbsp;</td><td bgcolor="#CC66CC">&nbsp;</td><td bgcolor="#CC66FF">&nbsp;</td><td bgcolor="#FF6600">&nbsp;</td><td bgcolor="#FF6633">&nbsp;</td><td bgcolor="#FF6666">&nbsp;</td><td bgcolor="#FF6699">&nbsp;</td><td bgcolor="#FF66CC">&nbsp;</td><td bgcolor="#FF66FF">&nbsp;</td></tr><tr><td bgcolor="#009900">&nbsp;</td><td bgcolor="#009933">&nbsp;</td><td bgcolor="#009966">&nbsp;</td><td bgcolor="#009999">&nbsp;</td><td bgcolor="#0099CC">&nbsp;</td><td bgcolor="#0099FF">&nbsp;</td><td bgcolor="#339900">&nbsp;</td><td bgcolor="#339933">&nbsp;</td><td bgcolor="#339966">&nbsp;</td><td bgcolor="#339999">&nbsp;</td><td bgcolor="#3399CC">&nbsp;</td><td bgcolor="#3399FF">&nbsp;</td><td bgcolor="#669900">&nbsp;</td><td bgcolor="#669933">&nbsp;</td><td bgcolor="#669966">&nbsp;</td><td bgcolor="#669999">&nbsp;</td><td bgcolor="#6699CC">&nbsp;</td><td bgcolor="#6699FF">&nbsp;</td></tr><tr><td bgcolor="#999900">&nbsp;</td><td bgcolor="#999933">&nbsp;</td><td bgcolor="#999966">&nbsp;</td><td bgcolor="#999999">&nbsp;</td><td bgcolor="#9999CC">&nbsp;</td><td bgcolor="#9999FF">&nbsp;</td><td bgcolor="#CC9900">&nbsp;</td><td bgcolor="#CC9933">&nbsp;</td><td bgcolor="#CC9966">&nbsp;</td><td bgcolor="#CC9999">&nbsp;</td><td bgcolor="#CC99CC">&nbsp;</td><td bgcolor="#CC99FF">&nbsp;</td><td bgcolor="#FF9900">&nbsp;</td><td bgcolor="#FF9933">&nbsp;</td><td bgcolor="#FF9966">&nbsp;</td><td bgcolor="#FF9999">&nbsp;</td><td bgcolor="#FF99CC">&nbsp;</td><td bgcolor="#FF99FF">&nbsp;</td></tr><tr><td bgcolor="#00CC00">&nbsp;</td><td bgcolor="#00CC33">&nbsp;</td><td bgcolor="#00CC66">&nbsp;</td><td bgcolor="#00CC99">&nbsp;</td><td bgcolor="#00CCCC">&nbsp;</td><td bgcolor="#00CCFF">&nbsp;</td><td bgcolor="#33CC00">&nbsp;</td><td bgcolor="#33CC33">&nbsp;</td><td bgcolor="#33CC66">&nbsp;</td><td bgcolor="#33CC99">&nbsp;</td><td bgcolor="#33CCCC">&nbsp;</td><td bgcolor="#33CCFF">&nbsp;</td><td bgcolor="#66CC00">&nbsp;</td><td bgcolor="#66CC33">&nbsp;</td><td bgcolor="#66CC66">&nbsp;</td><td bgcolor="#66CC99">&nbsp;</td><td bgcolor="#66CCCC">&nbsp;</td><td bgcolor="#66CCFF">&nbsp;</td></tr><tr><td bgcolor="#99CC00">&nbsp;</td><td bgcolor="#99CC33">&nbsp;</td><td bgcolor="#99CC66">&nbsp;</td><td bgcolor="#99CC99">&nbsp;</td><td bgcolor="#99CCCC">&nbsp;</td><td bgcolor="#99CCFF">&nbsp;</td><td bgcolor="#CCCC00">&nbsp;</td><td bgcolor="#CCCC33">&nbsp;</td><td bgcolor="#CCCC66">&nbsp;</td><td bgcolor="#CCCC99">&nbsp;</td><td bgcolor="#CCCCCC">&nbsp;</td><td bgcolor="#CCCCFF">&nbsp;</td><td bgcolor="#FFCC00">&nbsp;</td><td bgcolor="#FFCC33">&nbsp;</td><td bgcolor="#FFCC66">&nbsp;</td><td bgcolor="#FFCC99">&nbsp;</td><td bgcolor="#FFCCCC">&nbsp;</td><td bgcolor="#FFCCFF">&nbsp;</td></tr><tr><td bgcolor="#00FF00" title=lime>&nbsp;</td><td bgcolor="#00FF33">&nbsp;</td><td bgcolor="#00FF66">&nbsp;</td><td bgcolor="#00FF99">&nbsp;</td><td bgcolor="#00FFCC">&nbsp;</td><td bgcolor="#00FFFF" title=aqua>&nbsp;</td><td bgcolor="#33FF00">&nbsp;</td><td bgcolor="#33FF33">&nbsp;</td><td bgcolor="#33FF66">&nbsp;</td><td bgcolor="#33FF99">&nbsp;</td><td bgcolor="#33FFCC">&nbsp;</td><td bgcolor="#33FFFF">&nbsp;</td><td bgcolor="#66FF00">&nbsp;</td><td bgcolor="#66FF33">&nbsp;</td><td bgcolor="#66FF66">&nbsp;</td><td bgcolor="#66FF99">&nbsp;</td><td bgcolor="#66FFCC">&nbsp;</td><td bgcolor="#66FFFF">&nbsp;</td></tr><tr><td bgcolor="#99FF00">&nbsp;</td><td bgcolor="#99FF33">&nbsp;</td><td bgcolor="#99FF66">&nbsp;</td><td bgcolor="#99FF99">&nbsp;</td><td bgcolor="#99FFCC">&nbsp;</td><td bgcolor="#99FFFF">&nbsp;</td><td bgcolor="#CCFF00">&nbsp;</td><td bgcolor="#CCFF33">&nbsp;</td><td bgcolor="#CCFF66">&nbsp;</td><td bgcolor="#CCFF99">&nbsp;</td><td bgcolor="#CCFFCC">&nbsp;</td><td bgcolor="#CCFFFF">&nbsp;</td><td bgcolor="#FFFF00" title=yellow>&nbsp;</td><td bgcolor="#FFFF33">&nbsp;</td><td bgcolor="#FFFF66">&nbsp;</td><td bgcolor="#FFFF99">&nbsp;</td><td bgcolor="#FFFFCC">&nbsp;</td><td bgcolor="#FFFFFF" title=white>&nbsp;</td></tr></table>'];core.colorpickerShared.lu=[ '00','02','05','07','0A','0C','0F','11','14','16','19','1C','1E','21','23','26','28','2B','2D','30','33','35','38','3A','3D','3F','42','44','47','49','4C','4F','51','54','56','59','5B','5E','60','63','66','68','6B','6D','70','72','75','77','7A','7C','7F','82','84','87','89','8C','8E','91','93','96','99','9B','9E','A0','A3','A5','A8','AA','AD','AF','B2','B5','B7','BA','BC','BF','C1','C4','C6','C9','CC','CE','D1','D3','D6','D8','DB','DD','E0','E2','E5','E8','EA','ED','EF','F2','F4','F7','F9','FC','FF'];
