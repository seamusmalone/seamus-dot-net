// Copyright 2001-2003, Nebiru Software
// www.domapi.com
document.write('<style title="internalMenuExCss" type="text/css"><\/style>');core.loadUnit('thirdparty/kalm/menuitemex');core.loadUnit('shadow');core.registerComponent('menuex');core.comps.menuex.doShadow=false;core.comps.menuex.shadowColor='gray';core.comps.menuex.useCssFile=false;core.comps.menuex.usePrebuiltThemes=false;core.comps.menuex._prebuiltThemesAvailable=false;core.comps.menuex._useFastMode=core.isIE;function MenuEx(arg){var bgImage=arg["bgimage"];var imgTyp=typeof(bgImage);var e=core._component(arg,"menuex",false,'div');e.className='menu-body';e.style.position="absolute";e.outerBorder=document.createElement('div');e.outerBorder.className="outer-border";e.outerBorder.style.position="relative";e.innerBorder=document.createElement('div');e.innerBorder.className="inner-border";e.innerBorder.style.position="relative";e.table=document.createElement('tbody');e.table.style.position="relative";e.tbl=document.createElement('table');e.tbl.style.position="relative";e.tbl.setAttribute("border",0);e.tbl.setAttribute("cellPadding",0);e.tbl.setAttribute("cellSpacing",0);e.appendChild(e.outerBorder);e.outerBorder.appendChild(e.innerBorder);e.innerBorder.appendChild(e.tbl);e.tbl.appendChild(e.table);e.menuItems=e.table.childNodes;e.shadowW=core.rType(4,arg["shadowW"],"number");e.pushLevel=0;e.autoOpen=true;e.isOpen=false;e.isContextMenu=core.rType(false,arg["contextmenu"],"boolean");e.currItem=null;e.topItem=null;e.hasShadow=false;e.guid="";e.subMenues=new Array();e.branches=new Array();e.bgImage=(imgTyp=='undefined'||bgImage==null)?"":((imgTyp=='string')?bgImage:((imgTyp=='object')?bgImage.src:""));e.parentElm=arg["parentelm"]?arg["parentelm"]:null;if(e.bgImage!=""){e.style.backgroundImage="url("+e.bgImage+")"}if(core.comps.menuex.doShadow){core.shadow.dropShadow(e,e.shadowW,core.comps.menuex.shadowColor);e.hasShadow=true}core.disallowSelect(e);e.hide();e.reDraw();return e};core.comps.menuex._free=function(){var parent=this.parentNode;parent.removeChild(this);if(this.hasShadow){if(this.shadowsX)for(var a=0;a<this.shadowsX.length;a++){this.shadowsX[a].removeNode(true);this.shadowsY[a].removeNode(true)}this.shadowsX=null;this.shadowsY=null;this.hasShadow=null}this.tbl.removeChild(this.table);this.innerBorder.removeChild(this.tbl);this.outerBorder.removeChild(this.innerBorder);this.removeChild(this.outerBorder);this.table=null;this.tbl=null;this.innerBorder.className=null;this.innerBorder=null;this.outerBorder.className=null;this.outerBorder=null;this.className=null;this.menuItems=null;this.pushLevel=null;this.autoOpen=null;this.isOpen=null;this.currItem=null;this.topItem=null;this.bgImage=null;this.parentElm=null;this.guid=null;this.subMenues=[];this.subMenues=null;this.branches=[];this.branches=null};core.comps.menuex.reDraw=function(){this.menuReDraw();this.onredraw()};core.comps.menuex.menuReDraw=function(){if(null!=this.parentElm){var root=this.parentElm._getRoot();this.guid=root.guid;if(this.guid==""){this.className="menu-body"}else{this.className=this.guid+"_menu-body"}return}if(core.comps.menuex.useCssFile){this.guid="";this.className="menu-body";this._redrawMenues();return}if(core.comps.menuex.usePrebuiltThemes){this.guid=this.theme.name.replace(/\s/g,"");this.className=this.guid+"_menu-body";this._redrawMenues();return}if(core.comps.menuex._useFastMode&&core.isIE){this._writeCssSection();this.guid=this.theme.guid;this.className=this.guid+"_menu-bar";this._redrawMenues();return}core.comps.menuex._updateRules(this.theme.guid,this.theme);this.guid=this.theme.guid;this.className=this.guid+"_menu-bar";this._redrawMenues()};core.comps.menuex._writeCssSection=function(){var t=this.theme;var name=t.guid;var rules=core.comps.menuex._getComleteCss(name,t);var count=document.styleSheets.length;for(var index=0;index<count;index++){name=document.styleSheets[index].title;if(name=="internalMenuExCss"){document.styleSheets[index].cssText=rules}}};core.comps.menuex._updateRules=function(name,t){var count=document.styleSheets.length;var cssIndex=0;for(var index=0;index<count;index++){name=document.styleSheets[index].title;if(name=="internalMenuExCss"){cssIndex=index}}core.css.init(cssIndex);var rule='position:absolute;background-color:'+t.ctrlBgColor+';color:'+t.ctrlFgColor+';margin:0;padding:0;overflow:hidden;border:0;cursor:default;';core.css.addRule('.'+name+'_menu-body',rule,true);rule='border:1px solid;border-color:'+t.getOutset()+';';core.css.addRule('.'+name+'_menu-body .outer-border',rule,true);rule='border:1px solid;border-color:'+t.getInset()+';padding:1px;width:100%;height:100%;';core.css.addRule('.'+name+'_menu-body .inner-border',rule,true);rule='font:'+t.ctrlFont+';';core.css.addRule('.'+name+'_menu-body td',rule,true);rule='background-color:'+t.hlBgColor+';color:'+t.hlFgColor+';';core.css.addRule('.'+name+'_menu-body .hover',rule,true);rule='display:none;padding:0;';core.css.addRule('.'+name+'_menu-body .hidden',rule,true);rule='padding:0px 2px 0px 2px;border:0;';core.css.addRule('.'+name+'_menu-body td.empty-icon-cell',rule,true);rule='width:16px;';core.css.addRule('.'+name+'_menu-body td.empty-icon-cell span',rule,true);rule='padding:0px 2px 0px 2px;border:0;';core.css.addRule('.'+name+'_menu-body td.icon-cell',rule,true);rule='width:16px;height:16px;margin:0;';core.css.addRule('.'+name+'_menu-body td.icon-cell img',rule,true);rule='position:relative;left:-1px;top:-1px;';core.css.addRule('.'+name+'_menu-body .hover td.icon-cell img',rule,true);rule='width:100%;padding:0px 5px 0px 5px;';core.css.addRule('.'+name+'_menu-body td.label-cell',rule,true);rule='padding:0px 5px 0px 5px;';core.css.addRule('.'+name+'_menu-body td.shortcut-cell',rule,true);rule='width:20px;padding:0px 2px 0px 0px;font-family:Webdings;font-size:80%;';core.css.addRule('.'+name+'_menu-body td.arrow-cell',rule,true);rule='color:'+t.ctrlFgDisabled+';';core.css.addRule('.'+name+'_menu-body .disabled .disabled-container',rule,true);rule='background:transparent;width:100%;height:100%;'+core.css.addRule('.'+name+'_menu-body .disabled .icon-cell .disabled-container',rule,true);core.css.addRule('.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container',rule,true);rule='background:transparent;';core.css.addRule('.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container',rule,true);core.css.addRule('.'+name+'_menu-body .disabled .icon-cell .disabled-container .disabled-container',rule,true);core.css.addRule('.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container .disabled-container',rule,true);rule='background-color:'+t.selBgColor+';color:'+t.ctrlFgDisabled+';';core.css.addRule('.'+name+'_menu-body .disabled-hover td',rule,true);rule='font-size:0.001mm;padding:2px 10px 2px 10px;';core.css.addRule('.'+name+'_menu-body td.separator',rule,true);rule='overflow:hidden;height:1px;border-top:1px solid '+t.bdrDark+';border-bottom:1px solid '+t.bdrLight+';margin:0;';core.css.addRule('.'+name+'_menu-body .separator-line',rule,true);rule='width:16px;text-align:center;vertical-align:middle;';core.css.addRule('.'+name+'_menu-body .check-box',rule,true);core.css.addRule('.'+name+'_menu-body .radio-button',rule,true);rule='font-family:Webdings;font-size:110%;';core.css.addRule('.'+name+'_menu-body .checked .check-box',rule,true);core.css.addRule('.'+name+'_menu-body .checked .radio-button',rule,true);rule='background:'+t.ctrlBgColor+';cursor:default;padding:1px;';core.css.addRule('.'+name+'_menu-bar',rule,true);rule='background:transparent;color:'+t.ctrlFgColor+';font:'+t.ctrlFont+';padding:3px 7px 3px 7px;border:0;margin:0;display:inline-block;white-space:nowrap;cursor:default;';core.css.addRule('.'+name+'_menu-bar .menu-button',rule,true);rule='padding:3px 5px 1px 7px;border:1px solid;border-color:'+t.getInset()+';';core.css.addRule('.'+name+'_menu-bar .menu-button.active',rule,true);rule='background-color:'+t.hlBgColor+';color:'+t.hlFgColor+';padding:2px 6px 2px 6px;border:1px solid;border-color:'+t.getOutset()+';';core.css.addRule('.'+name+'_menu-bar .menu-button.hover',rule,true);rule='color:'+t.ctrlFgDisabled+';';core.css.addRule('.'+name+'_menu-bar .menu-button.disabled',rule,true);rule='display:none;padding:0;';core.css.addRule('.'+name+'_menu-bar .menu-button.hidden',rule,true)};core.comps.menuex._getComleteCss=function(name,t){var rules='.'+name+'_menu-body {position:absolute;background-color:'+t.ctrlBgColor+';color:'+t.ctrlFgColor+';margin:0;padding:0;overflow:hidden;border:0;cursor:default}.'+name+'_menu-body .outer-border {}.'+name+'_menu-body .inner-border {border:1px solid;border-color:'+t.getInset()+';padding:2px;width:100%;height:100%}.'+name+'_menu-body td {font:'+t.ctrlFont+'}.'+name+'_menu-body .hover {background-color:'+t.hlBgColor+';color:'+t.hlFgColor+'}.'+name+'_menu-body .hidden {display:none;padding:0}.'+name+'_menu-body td.empty-icon-cell {padding:0px 2px 0px 2px;border:0}.'+name+'_menu-body td.empty-icon-cell span {width:16px}.'+name+'_menu-body td.icon-cell {padding:0px 2px 0px 2px;border:0}.'+name+'_menu-body td.icon-cell img {width:16px;height:16px;margin:0}.'+name+'_menu-body .hover td.icon-cell img {position:relative;left:-1px;top:-1px}.'+name+'_menu-body td.label-cell {width:100%;padding:0px 5px 0px 5px}.'+name+'_menu-body td.shortcut-cell {padding:0px 5px 0px 5px}.'+name+'_menu-body td.arrow-cell {width:20px;padding:0px 2px 0px 0px;font-family:Webdings;font-size:80%}.'+name+'_menu-body .disabled .disabled-container {color:'+t.ctrlFgDisabled+'}.'+name+'_menu-body .disabled .icon-cell .disabled-container,.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container {background:transparent;width:100%;height:100%}.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container {background:transparent}.'+name+'_menu-body .disabled .icon-cell .disabled-container .disabled-container,.'+name+'_menu-body .disabled-hover .icon-cell .disabled-container .disabled-container {background:transparent}.'+name+'_menu-body .disabled-hover td {background-color:'+t.selBgColor+';color:'+t.ctrlFgDisabled+'}.'+name+'_menu-body td.separator {font-size:0.001mm;padding:2px 10px 2px 10px}.'+name+'_menu-body .separator-line {overflow:hidden;height:1px;border-top:1px solid '+t.bdrDark+';border-bottom:1px solid '+t.bdrLight+';margin:0}.'+name+'_menu-body .check-box,.'+name+'_menu-body .radio-button {width:16px;text-align:center;vertical-align:middle}.'+name+'_menu-body .checked .check-box {font-family:Webdings;font-size:110%}.'+name+'_menu-body .checked .radio-button {font-family:Webdings;font-size:110%}.'+name+'_menu-bar {background:'+t.ctrlBgColor+';cursor:default;padding:1px}.'+name+'_menu-bar .menu-button {background:transparent;color:'+t.ctrlFgColor+';font:'+t.ctrlFont+';padding:3px 7px 3px 7px;border:0;margin:0;display:inline-block;white-space:nowrap;cursor:default}.'+name+'_menu-bar .menu-button.active {background-color:'+t.hlBgColor+';color:'+t.hlFgColor+';padding:3px 5px 1px 7px;border:1px solid;border-color:'+t.getInset()+'}.'+name+'_menu-bar .menu-button.hover {padding:2px 6px 2px 6px;border:1px solid;border-color:'+t.getOutset()+'}.'+name+'_menu-bar .menu-button.disabled {color:'+t.ctrlFgDisabled+'}.'+name+'_menu-bar .menu-button.hidden {display:none;padding:0}';return rules};core.comps.menuex._getTopItem=function(){if(this.branches.length>0){return this.branches[ this.branches.length-1]}return this};core.comps.menuex._popAll=function(){if(this.branches.length>0){var item;var index;for(index=0;index<this.branches.length;index++){item=this.branches[ index ];if(null!=item.dropDown){item.dropDown.pushLevel=core.max(0,--item.dropDown.pushLevel)}}this.branches.pop()}};core.comps.menuex._pushAll=function(){if(this.branches.length>1){var item;var index;for(index=0;index<this.branches.length-1;index++){item=this.branches[ index ];if(null!=item.dropDown){item.dropDown.pushLevel++}}}};core.comps.menuex._open=function(newItem){var nextItem,thisItem=this.currItem;if(this.currItem!=newItem){while(null!=thisItem){thisItem._hilite(false);if(null!=thisItem.dropDown){nextItem=thisItem.dropDown.currItem;thisItem.dropDown.currItem=null;thisItem=nextItem}else thisItem=null}this.currItem=newItem;if(null==this.currItem){this._setOpen(this.autoOpen);if(this.isContextMenu)this.hide()}}};core.comps.menuex._setOpen=function(flag){this.isOpen=flag;var index=0;for(index=0;index<this.menuItems.length;index++){this.menuItems[index].autoOpen=this.isOpen}};core.comps.menuex._redrawMenues=function(){var index;var item;for(index=0;index<this.subMenues.length;index++){item=this.subMenues[index];if(null!=item.dropDown){item.dropDown.reDraw()}}};core.comps.menuex.add=function(caption,args){if(this.pushLevel>0){var item=this.topItem;item._addDropDown();var dropDown=item.dropDown;return dropDown.table.appendChild(MenuitemEx(dropDown,caption,false,dropDown.autoOpen,args?args:{}))}else{return this.table.appendChild(MenuitemEx(this,caption,false,this.autoOpen,args?args:{}))}};core.comps.menuex.push=function(caption,args){if(this.pushLevel>0){this._pushAll();var item=this.topItem;item._addDropDown();var dropDown=item.dropDown;dropDown.pushLevel++;this.topItem=dropDown.table.appendChild(MenuitemEx(dropDown,caption,false,dropDown.autoOpen,args?args:{}))}else{this.topItem=this.table.appendChild(MenuitemEx(this,caption,false,this.autoOpen,args?args:{}))}this.pushLevel++;this.subMenues.push(this.topItem);this.branches.push(this.topItem);return this.topItem};core.comps.menuex.pop=function(){if(this.pushLevel>0){this._popAll()}this.pushLevel=core.max(0,--this.pushLevel);this.topItem=this._getTopItem();return this.topItem};core.comps.menuex.separator=function(){if(this.pushLevel>0){var item=this.topItem;item._addDropDown();var dropDown=item.dropDown;return dropDown.table.appendChild(MenuitemEx(dropDown,"",true,dropDown.autoOpen,{}))}return this.table.appendChild(MenuitemEx(this,"",true,false,{}))};core.comps.menuex.initMenu=function(){this.setW(16);var arr=new Array();var index;var items=this.menuItems;for(index=0;index<items.length;index++){items[index]._OnUpdateCmdUI();items[index].reDraw();if(items[index].visible){arr.push(items[index])}}for(index=0;index<arr.length-1;index++){if(arr[index].isSeparator&&arr[index+1].isSeparator){arr[index]._setVisible(false);arr[index].reDraw()}}if(arr.length>0){if(arr[arr.length-1].isSeparator){arr[arr.length-1]._setVisible(false);arr[arr.length-1].reDraw()}if(arr[0].isSeparator){arr[0]._setVisible(false);arr[0].reDraw()}}this.tbl.refresh();this.setW(this.tbl.offsetWidth)};core.comps.menuex.close=function(){this._open(null)};core.comps.menuex.setBgImage=function(bgImage){var imgTyp=typeof(bgImage);this.bgImage=(imgTyp=='undefined'||bgImage==null)?"":((imgTyp=='string')?bgImage:((imgTyp=='object')?bgImage.src:""));this.style.backgroundImage="url("+this.bgImage+")"};core.comps.menuex.applyTheme=function(theme){this.theme=core.rTheme(theme);this.reDraw()};
