// Copyright 2001-2003, Nebiru Software
// www.domapi.com
core.loadUnit("speedbutton");core.registerComponent("pagecontrol");function Pagecontrol(arg){var e=core._component(arg,"pagecontrol");e.backDrop=core.createElm(e,null,null,null,null,e.theme.ctrlBgColor);e.style.fontFamily='"MS Sans Serif",Geneva,sans-serif';e.style.fontSize="10pt";e.pageIndex=0;e.onbeforechange=function(i){return true};e.onchange=function(i){};e.tabs=[];e.pages=[];e.sbL=Speedbutton({parent:e,x:0,y:0,w:16,h:17,img:core.imagePath+"buttons/pgl.gif",imgW:5,imgH:8,imgCount:2});e.sbR=Speedbutton({parent:e,x:0,y:0,w:16,h:17,img:core.imagePath+"buttons/pgr.gif",imgW:5,imgH:8,imgCount:2});e.sbL.setZ(1000);e.sbR.setZ(1000);e.sbL.onclick=function(){if(this.enabled)this.parentNode.scrollTabs(-1)};e.sbR.onclick=function(){if(this.enabled)this.parentNode.scrollTabs(1)};e.visibleLeft=0;e.reDraw();return e};core.comps.pagecontrol.btnIndex=2;core.comps.pagecontrol.btnSpacing=2;core.comps.pagecontrol.constTabH=23;core.comps.pagecontrol.constTabP=30;core.comps.pagecontrol.tabPos="top";core.comps.pagecontrol.doScrollTabs=true;core.comps.pagecontrol.doAutoHide=false;core.comps.pagecontrol.reDraw=function(){this.pagecontrolReDraw();this.onredraw()};core.comps.pagecontrol.pagecontrolReDraw=function(){var t=this.backDrop;t.setB(this.theme.bdrWidth);t.style.borderStyle=this.theme.bdrSolid;t.style.borderColor=this.theme.getOutset();t.setBgColor(this.theme.ctrlBgColor);t.setColor(this.theme.ctrlFgColor);t.setZ(this.getZ()+1);t.setW(this.getW());t.setH(this.getH()-this.constTabH+this.theme.bdrWidth);switch(this.tabPos){case "top":t.setY(this.constTabH-this.theme.bdrWidth);break;case "bottom":t.setY(0);break}var thereIsOverflow=false;var x=0;var t;for(var a=0;a<this.tabs.length;a++){t=this.tabs[a];var b=core.rInt(this.theme.bdrWidth);switch(this.tabPos){case "top":t.setB([b,b,0,b]);break;case "bottom":t.setB([0,b,b,b]);break}t.style.borderStyle=this.theme.bdrSolid;t.style.borderColor=this.theme.getOutset();t.setBgColor(this.theme.ctrlBgColor);t.setColor(this.theme.ctrlFgColor);t.style.textAlign="center";t.style.cursor="default";t.setX(x);switch(this.tabPos){case "top":t.setY(this.pageIndex==a?0:2);t.style.lineHeight="normal";break;case "bottom":t.setY(this.backDrop.getH()-(this.pageIndex==a?0:2)-2);t.style.lineHeight=this.constTabH+"px";break}t.setW(this.tabs[a].innerHTML.length*5.5+this.constTabP);t.setH(this.constTabH);t.setZ(this.pageIndex==a?(this.getZ()+2):this.getZ());if((a>=this.visibleLeft)||!this.doScrollTabs){if(t.style.visibility=="visible")x+=t.getW();if(x>this.getW())thereIsOverflow=true;t.show()}else t.hide()}for(var a=0;a<this.pages.length;a++){t=this.pages[a];t.setM(5);t.setW(this.backDrop.getW()-10-(core.isIE?3:6));t.setH(this.backDrop.getH()-10-(core.isIE?3:6));t.style.visibility=this.pageIndex==a?"visible":"hidden"}var L=this.sbL;var R=this.sbR;t=this.theme;L.theme=t;L.reDraw();R.theme=t;R.reDraw();var h=this.tabPos=="top"?4:this.getH()-21;var w=this.getW();b=this.btnIndex;var _w=R.getW();L.moveTo(w-b-_w*2-this.btnSpacing,h);R.moveTo(w-b-_w,h);L.setEnabled(this.visibleLeft>0);R.setEnabled(thereIsOverflow);var shouldShow=(L.enabled||R.enabled);if(!this.doAutoHide)shouldShow=true;L.style.visibility=(this.doScrollTabs&&shouldShow)?"visible":"hidden";R.style.visibility=L.style.visibility};core.comps.pagecontrol.addPage=function(caption,controlType,url){controlType=core.rVal(controlType,"DIV");this.tabs[this.tabs.length]=core.createElm(this,0,0,null,null,this.theme.ctrlBgColor,this.theme.ctrlFgColor,"DIV");var newTab=this.tabs[this.tabs.length-1];newTab.setText(core.rVal(caption,"New Page"));newTab.index=this.tabs.length-1;newTab.onclick=this.switchTab;newTab.onmouseover=this.mouseover;newTab.onmouseout=this.mouseout;core.disallowSelect(newTab);switch(controlType){case "DIV":case "IFRAME":case "TEXTAREA":case "P":this.pages[this.pages.length]=core.createElm(this.backDrop,0,0,100,100,null,null,controlType);break}var i=this.pages[this.pages.length-1];i.domAPIObjType="PAGECONTROLPAGE";if(controlType=="IFRAME"){i.src=core.rVal(url,"about:blank");i.frameBorder="0";i.style.margin="2px";i.style.overflow="auto"}i.index=this.pages.length-1;this.reDraw();return{tab:newTab,page:i,index:i.index}};core.comps.pagecontrol.assignElement=function(elmid,toIndex,overwrite,caption){var original=core.getElm(elmid);if(!original)return;if(overwrite==null)overwrite=true;original.parentNode.removeChild(original);if(!toIndex&&toIndex!=0){this.addPage(caption,"DIV");toIndex=this.pages.length-1}while(this.pages.length<toIndex+1)this.addPage(null,"DIV");if(overwrite)this.pages[toIndex].innerHTML="";this.pages[toIndex].appendChild(original);if(caption)this.tabs[toIndex].setText(caption)};core.comps.pagecontrol.clearPages=function(){for(var a=0;a<this.tabs.length;a++){this.tabs[ a].parentNode.removeChild(this.tabs[ a]);this.pages[a].parentNode.removeChild(this.pages[a])}this.tabs.length=0;this.pages.length=0;this.reDraw()};core.comps.pagecontrol.switchTab=function(e){var p=this.parentNode;if(!p.enabled)return;if(p.pageIndex==this.index)return;if(!p.onbeforechange(this.index))return;p.pageIndex=this.index;p.onchange(this.index);p.reDraw()};core.comps.pagecontrol.mouseover=function(){var p=this.parentNode;if(!p.doRollover||!p.enabled||p.pageIndex==this.index)return;var t=p.theme;this.setBgColor(t.hlBgColor);this.setColor(t.hlFgColor)};core.comps.pagecontrol.mouseout=function(){var p=this.parentNode;if(!p.doRollover)return;var t=p.theme;this.setBgColor(t.ctrlBgColor);this.setColor(t.ctrlFgColor)};core.comps.pagecontrol.scrollTabs=function(i){this.visibleLeft+=i;this.reDraw()};core.comps.pagecontrol.hideTab=function(i){this.tabs[i].style.display="none";this.tabs[i].hide();this.pages[i].hide();this.reDraw()};core.comps.pagecontrol.showTab=function(i){this.tabs[i].style.display="inline";this.tabs[i].show();this.pages[i].show();this.reDraw()};
