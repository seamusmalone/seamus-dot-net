// Copyright 2001-2003, Nebiru Software
// www.domapi.com
core.animate=new Object();core.elmProto.glideTo=function(endx,endy,glideType,steps,speed,fn,x1,y1,x2,y2,x3,y3){if(this.isPath)return;if(this.isGlide)clearTimeout(this.fly);core.rInt(endx,this.getX());core.rInt(endy,this.getY());endx=Math.round(endx);endy=Math.round(endy);core.rInt(steps,50);core.rInt(speed,20);core.rInt(glideType,3);this.vSlidex=this.getX();this.vSlidey=this.getY();var distx=endx-this.vSlidex;var disty=endy-this.vSlidey;var scalex=distx/((Math.pow(steps,2)+2*steps+1)/(4*steps));var scaley=disty/((Math.pow(steps,2)+2*steps+1)/(4*steps));this.isGlide=true;core.animate._GlideDomElm(this.domAPIIndex,glideType,distx,disty,scalex,scaley,endx,endy,steps,1,speed,fn,x1,y1,x2,y2,x3,y3)};core.elmProto.glideBy=function(distx,disty,glideType,steps,speed,fn,x1,y1,x2,y2,x3,y3){var endx=this.getX()+distx;var endy=this.getY()+disty;this.glideTo(endx,endy,glideType,steps,speed,fn,x1,y1,x2,y2,x3,y3)};core.animate._GlideDomElm=function(elmIndex,type,distx,disty,scalex,scaley,endx,endy,steps,count,speed,fn,x1,y1,x2,y2,x3,y3){var elm=core.bags.elms[elmIndex];var sv=count/steps;if(count<=steps){switch(parseInt(type)){case 1:elm.vSlidex+=scalex*Math.pow(sv,3);elm.vSlidey+=scaley*Math.pow(sv,3);break;case 2:elm.vSlidex+=scalex*Math.pow(((steps-count)+1)/steps,3);elm.vSlidey+=scaley*Math.pow(((steps-count)+1)/steps,3);if(Math.round(elm.vSlidex)==endx&&Math.round(elm.vSlidey)==endy)count=steps;break;case 3:elm.vSlidex+=distx/steps;elm.vSlidey+=disty/steps;break;case 4:elm.vSlidex=endx*Math.pow(sv,3)+x1*3*Math.pow(sv,2)*(1-sv)+x2*3*sv*Math.pow(1-sv,2)+x3*Math.pow(1-sv,3);elm.vSlidey=endy*Math.pow(sv,3)+y1*3*Math.pow(sv,2)*(1-sv)+y2*3*sv*Math.pow(1-sv,2)+y3*Math.pow(1-sv,3);break}elm.moveTo(Math.round(elm.vSlidex),Math.round(elm.vSlidey));count++;elm.fly=setTimeout("core.animate._GlideDomElm(\""+elmIndex+"\","+type+","+distx+","+disty+","+scalex+","+scaley+","+endx+","+endy+","+steps+","+count+","+speed+",\""+fn+"\","+x1+","+y1+","+x2+","+y2+","+x3+","+y3+")",speed)}else{elm.isGlide=false;elm.moveTo(endx,endy);if(fn!="undefined")eval(fn)}};core.elmProto.sizeTo=function(endw,endh,growType,steps,speed,fn){if(this.isGrow)clearTimeout(this.fly);core.rInt(endw,this.getW());core.rInt(endh,this.getH());endw=Math.round(endw);endh=Math.round(endh);core.rInt(steps,50);core.rInt(speed,20);core.rInt(growType,3);this.vGroww=this.getW();this.vGrowh=this.getH();var distw=endw-this.vGroww;var disth=endh-this.vGrowh;var scalew=distw/((Math.pow(steps,2)+2*steps+1)/(4*steps));var scaleh=disth/((Math.pow(steps,2)+2*steps+1)/(4*steps));this.isGrow=true;core.animate._sizeDomElm(this.domAPIIndex,growType,distw,disth,scalew,scaleh,endw,endh,steps,1,speed,fn)};core.elmProto.sizeBy=function(distw,disth,growType,steps,speed,fn){var endw=this.getW()+distw;var endh=this.getH()+disth;this.sgrowTo(endw,endh,growType,steps,speed,fn)};core.animate._sizeDomElm=function(elmIndex,type,distw,disth,scalew,scaleh,endw,endh,steps,count,speed,fn){var elm=core.bags.elms[elmIndex];if(count<steps){switch(parseInt(type)){case 1:elm.vGroww+=scalew*Math.pow(count/steps,3);elm.vGrowh+=scaleh*Math.pow(count/steps,3);break;case 2:elm.vGroww+=scalew*Math.pow(((steps-count)+1)/steps,3);elm.vGrowh+=scaleh*Math.pow(((steps-count)+1)/steps,3);if(Math.round(elm.vGroww)==endw&&Math.round(elm.vGrowh)==endh)count=steps;break;case 3:elm.vGroww+=distw/steps;elm.vGrowh+=disth/steps;break}elm.setSize(Math.round(elm.vGroww),Math.round(elm.vGrowh));count++;elm.fly=setTimeout("core.animate._sizeDomElm(\""+elmIndex+"\","+type+","+distw+","+disth+","+scalew+","+scaleh+","+endw+","+endh+","+steps+","+count+","+speed+",\""+fn+"\")",speed)}else{elm.isGrow=false;elm.setSize(endw,endh);if(fn!="undefined")eval(fn)}};core.elmProto.clipTo=function(endt,endr,endb,endl,growType,steps,speed,fn){if(this.isClip)clearTimeout(this.fly);if(this.style.clip=="")this.setClip(0,this.getW(),this.getH(),0);var clipVals=this.style.clip.split("rect(")[1].split(" ");for(var i=0;i<clipVals.length;i++)clipVals[i]=parseInt(clipVals[i]);if(!endt||endt<0)endt=0;core.rInt(endr);core.rInt(endb);if(!endl||endl<0)endl=0;if(endr>this.getW())endr=this.getW();if(endb>this.getH())endb=this.getH();if(endt>(this.getH()/2))endt=this.getH()/2;if(endr<(this.getW()/2))endr=this.getW()/2;if(endb<(this.getH()/2))endb=this.getH()/2;if(endl>(this.getW()/2))endl=this.getW()/2;endt=Math.round(endt);endr=Math.round(endr);endb=Math.round(endb);endl=Math.round(endl);core.rInt(steps,50);core.rInt(speed,20);core.rInt(growType,3);this.vClipt=clipVals[0];this.vClipr=clipVals[1];this.vClipb=clipVals[2];this.vClipl=clipVals[3];var distt=endt-this.vClipt;var distr=this.vClipr-endr;var distb=this.vClipb-endb;var distl=endl-this.vClipl;var factor=((Math.pow(steps,2)+2*steps+1)/(4*steps));var scalet=distt/factor;var scaler=distr/factor;var scaleb=distb/factor;var scalel=distl/factor;this.isClip=true;core.animate._clipDomElm(this.domAPIIndex,growType,distt,distr,distb,distl,scalet,scaler,scaleb,scalel,endt,endr,endb,endl,steps,1,speed,fn)};core.elmProto.clipBy=function(distt,distr,distb,distl,growType,steps,speed,fn){if(this.style.clip=="")this.setClip(0,this.getW(),this.getH(),0);var clipVals=this.style.clip.split("rect(")[1].split(" ");for(var i=0;i<clipVals.length;i++)clipVals[i]=parseInt(clipVals[i]);var endt=clipVals[0]+distt;var endr=clipVals[1]-distr;var endb=clipVals[2]-distb;var endl=clipVals[3]+distl;this.clipTo(endt,endr,endb,endl,growType,steps,speed,fn)};core.animate._clipDomElm=function(elmIndex,type,distt,distr,distb,distl,scalet,scaler,scaleb,scalel,endt,endr,endb,endl,steps,count,speed,fn){var elm=core.bags.elms[elmIndex];if(count<steps){switch(parseInt(type)){case 1:var fact=Math.pow(count/steps,3);elm.vClipt+=scalet*fact;elm.vClipr-=scaler*fact;elm.vClipb-=scaleb*fact;elm.vClipl+=scalel*fact;break;case 2:var fact=Math.pow(((steps-count)+1)/steps,3);elm.vClipt+=scalet*fact;elm.vClipr-=scaler*fact;elm.vClipb-=scaleb*fact;elm.vClipl+=scalel*fact;if(Math.round(elm.vClipt)==endt&&Math.round(elm.vClipr)==endr&&Math.round(elm.vClipb)==endb&&Math.round(elm.vClipl)==endl)count=steps;break;case 3:elm.vClipt+=distt/steps;elm.vClipr-=distr/steps;elm.vClipb-=distb/steps;elm.vClipl+=distl/steps;break}elm.setClip(Math.round(elm.vClipt),Math.round(elm.vClipr),Math.round(elm.vClipb),Math.round(elm.vClipl));count++;elm.fly=setTimeout("core.animate._clipDomElm(\""+elmIndex+"\","+type+","+distt+","+distr+","+distb+","+distl+","+scalet+","+scaler+","+scaleb+","+scalel+","+endt+","+endr+","+endb+","+endl+","+steps+","+count+","+speed+",\""+fn+"\")",speed)}else{elm.isClip=false;elm.setClip(endt,endr,endb,endl);if(fn!="undefined")eval(fn)}};core.elmProto.pathSlide=function(listX,listY,start,steps,speed){if(listX.length!=listY.length||!listX||this.isGlide||start>listX.length||this.isPath)return;core.rInt(start);core.rInt(steps,5);core.rInt(speed,20);this.listX=listX;this.listY=listY;this.pCount=start;this.isPath=true;core.animate._pathDomElm(this.domAPIIndex,steps,speed)};core.animate._pathDomElm=function(elmIndex,steps,speed){var elm=core.bags.elms[elmIndex];if(elm.pCount<elm.listX.length){endx=elm.listX[elm.pCount];endy=elm.listY[elm.pCount];elm.vSlidex=elm.getX();elm.vSlidey=elm.getY();distx=elm.listX[elm.pCount]-elm.vSlidex;disty=elm.listY[elm.pCount]-elm.vSlidey;elm.pCount++;core.animate._pathGlideDomElm(elmIndex,distx,disty,endx,endy,steps,1,speed,"core.animate._pathDomElm(elmIndex,steps,speed)")}else{elm.isPath=false}};core.animate._pathGlideDomElm=function(elmIndex,distx,disty,endx,endy,steps,count,speed,fn){var elm=core.bags.elms[elmIndex];if(count<=steps){elm.vSlidex+=distx/steps;elm.vSlidey+=disty/steps;elm.moveTo(Math.round(elm.vSlidex),Math.round(elm.vSlidey));count++;elm.fly=setTimeout("core.animate._pathGlideDomElm(\""+elmIndex+"\","+distx+","+disty+","+endx+","+endy+","+steps+","+count+","+speed+",\""+fn+"\")",speed)}else{elm.moveTo(endx,endy);eval(fn)}};
