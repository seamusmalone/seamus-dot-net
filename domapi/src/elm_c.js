// Copyright 2001-2003, Nebiru Software
// www.domapi.com
core._addElmProtos=function(e){var p=core.elmProto;try{if(e.tagName=="IFRAME"&&core.isIE50){for(var a in p)if(a!="visible")e[a]=p[a]}else for(var a in p)e[a]=p[a]}catch(E){alert('Error applying "elmProto.'+a+'"to a(n) '+e.tagName+"\non "+navigator.userAgent+"\n\nPlease notify support@domapi.com of this problem")}};core.Elm=function(i){var e=core.getElm(i);if(!e)return null;return core.Elm2(e)};core.Elm2=function(e){core._addElmProtos(e);e.domAPIObjType="ELM";var elms=core.bags.elms;e.domAPIIndex=elms.length;elms[e.domAPIIndex]=e;e.freed=false;return e};core.createElm=function(p,x,y,w,h,bg,c,t){t=core.rVal(t,"DIV").toUpperCase();var o=(t=="IFRAME")?core.createIFrame():document.createElement(t);o.id="domAPI_Elm_"+core.bags.elms.length;if(p)p.appendChild(o);else document.body.appendChild(o);var e=core.Elm2(o);if(x==null&&y==null)e.setPosition("relative");else{e.moveTo(core.rInt(x),core.rInt(y));e.setOverflow("hidden")}if(!core.isNil(c))e.setColor(c);if(!core.isNil(bg))e.setBgColor(bg);if(!core.isNil(w))e.setW(w);if(!core.isNil(h))e.setH(h);return e};core.createIFrame=function(n){n=core.rVal(n,'frame_'+(core.bags.elms.length));if(core.isIE5){var e=document.createElement("DIV");e.innerHTML='<iframe name="'+n+'" src=""></iframe>';e=e.removeChild(e.children[0])}else var e=document.createElement("IFRAME");e.getDocument=function(){var doc;if(core.isIE5)doc=this.document;else doc=core.isIE?this.contentWindow.document:this.contentDocument;return doc};e.Hide=function(){if(core.isIE5)this.style.display="none";else{this.style.visibility="hidden";this.width=0;this.height=0}};return e};core._freeElm=function(e){if(!e.freed){for(var a in core.elmProto)e[a]=null;e.domAPIObjType=null;e.domAPIIndex=null;e.freed=true}};core._freeBag=function(bag){if(bag.isComponent){for(var index=bag.length-1;index>=0;index--){var component=bag[index];if(component&&!component.freed)core._freeComponent(component);bag[index]=null}}else{for(var index=bag.length-1;index>=0;index--){var elm=bag[index];if(elm&&!elm.freed)core._freeElm(elm);bag[index]=null}}bag=[]};core._freeAll=function(){var arr=[];for(var bag in core.bags)arr.push(bag);for(var index=arr.length-1;index>=0;index--)core._freeBag(core.bags[arr[index]]);core.bags=null;arr=null};core.elmProto={};core.elmProto.hooks={};core.useElmHooks=false;core.elmProto.regHook=function(nm,func){var h=core.elmProto.hooks[nm];if(h)h[h.length]=func;else core.elmProto.hooks[nm]=[func]};core.elmProto.unRegHook=function(nm,func){var h=core.elmProto.hooks[nm];if(!h)return 0;var i=h.indexOf(func);if(i==-1)return 0;h.deleteItem(i);return 1};core.elmProto._dispHook=function(nm,args){var h=core.elmProto.hooks[nm];if(!h)return;for(var a=0;a<h.length;a++)h[a](this,args)};core.elmProto.getX=function(){if(core.useElmHooks)this._dispHook("getX",arguments);return this.offsetLeft};core.elmProto.getY=function(){if(core.useElmHooks)this._dispHook("getY",arguments);return this.offsetTop};core.elmProto.getW=function(){if(core.useElmHooks)this._dispHook("getW",arguments);return this.offsetWidth};core.elmProto.getH=function(){if(core.useElmHooks)this._dispHook("getH",arguments);return this.offsetHeight};core.elmProto.getP=function(){if(core.useElmHooks)this._dispHook("getP",arguments);return core.boxValuesOut(this.style.padding)};core.elmProto.getM=function(){if(core.useElmHooks)this._dispHook("getM",arguments);return core.boxValuesOut(this.style.margin)};core.elmProto.getB=function(){if(core.useElmHooks)this._dispHook("getB",arguments);return core.boxValuesOut(this.style.borderWidth)};core.elmProto.getZ=function(){if(core.useElmHooks)this._dispHook("getZ",arguments);return core.rInt(this.style.zIndex)};core.elmProto.getColor=function(){if(core.useElmHooks)this._dispHook("getColor",arguments);return core.color.makeSureIsHexColor(this.style.color)};core.elmProto.getBgColor=function(){if(core.useElmHooks)this._dispHook("getBgColor",arguments);return core.color.makeSureIsHexColor(this.style.backgroundColor)};core.elmProto.getOverflow=function(){if(core.useElmHooks)this._dispHook("getOverflow",arguments);return this.style.overflow};core.elmProto.getPosition=function(){if(core.useElmHooks)this._dispHook("getPosition",arguments);return(!this.fixed)?this.style.position:"fixed"};core.elmProto.getText=function(){if(core.useElmHooks)this._dispHook("getText",arguments);return this.innerHTML};core.elmProto.getClip=function(){if(core.useElmHooks)this._dispHook("getClip",arguments);if(core.isNil(this.style.clip)||this.style.clip=="auto")return [0,this.getW(),this.getH(),0];var c=this.style.clip.split("rect(")[1].split(" ");for(var i=0;i<c.length;i++)c[i]=parseInt(c[i]);return c};core.elmProto.setX=function(x,cancelBubble){if(!cancelBubble)var oldX=this.getX();this.style.left=core.rInt(x)+"px";if(!cancelBubble){if(core.useElmHooks)this._dispHook("setX",arguments);if(typeof this.onmove=="function")this.onmove(oldX,null,x,null)}};core.elmProto.setY=function(y,cancelBubble){if(!cancelBubble)var oldY=this.getY();this.style.top=core.rInt(y)+"px";if(!cancelBubble){if(core.useElmHooks)this._dispHook("setY",arguments);if(typeof this.onmove=="function")this.onmove(null,oldY,null,y)}};core.elmProto.setW=function(w,cancelBubble){w=core.rInt(w);if(w<0)return false;if(!cancelBubble)var oldW=this.getW();if(!core.needsBoxFix){var b=this.getB();var p=this.getP();w-=b[1]+b[3]+p[1]+p[3];if(w<0)w=0}this.style.width=w+"px";if(!cancelBubble){if(core.useElmHooks)this._dispHook("setW",arguments);if(typeof this.onresize=="function")this.onresize(oldW,null,w,null)}};core.elmProto.setH=function(h,cancelBubble){h=core.rInt(h);if(h<0)return false;if(!cancelBubble)var oldH=this.getH();if(!core.needsBoxFix){var b=this.getB();var p=this.getP();h-=b[0]+b[2]+p[0]+p[2];if(h<0)h=0}this.style.height=h+"px";if(!cancelBubble){if(core.useElmHooks)this._dispHook("setH",arguments);if(typeof this.onresize=="function")this.onresize(null,oldH,null,h)}};core.elmProto.setP=function(t,r,b,l){if(!core.needsBoxFix){var w=this.getW();var h=this.getH()}this.style.padding=core.boxValuesIn(t,r,b,l);if(!core.needsBoxFix){this.setW(w);this.setH(h)}if(core.useElmHooks)this._dispHook("setP",arguments)};core.elmProto.setB=function(t,r,b,l){if(!core.needsBoxFix){var w=this.getW();var h=this.getH()}this.style.borderWidth=core.boxValuesIn(t,r,b,l);if(!core.needsBoxFix){this.setW(w);this.setH(h)}if(core.useElmHooks)this._dispHook("setB",arguments)};core.elmProto.setM=function(t,r,b,l){this.style.margin=core.boxValuesIn(t,r,b,l)};core.elmProto.copyright=core.copyright;core.elmProto.setZ=function(z){z=core.rInt(z);this.style.zIndex=z;var p=this.parentNode;if(z>core.rInt(p._maxZ))p._maxZ=z;if(z<core.rInt(p._minZ))p._minZ=z;if(core.useElmHooks)this._dispHook("setZ",arguments)};core.elmProto.setColor=function(c){this.style.color=c};core.elmProto.setBgColor=function(c){this.style.backgroundColor=c};core.elmProto.setOverflow=function(f){this.style.overflow=core.rVal(f,"visible")};core.elmProto.setClip=function(t,r,b,l){if(typeof(t)=="object"&&t.length){r=t[1];b=t[2];l=t[3];t=t[0]}this.style.clip="rect("+core.rInt(t)+"px "+core.rInt(r,this.getW())+"px "+core.rInt(b,this.getH())+"px "+core.rInt(l)+"px)";if(core.useElmHooks)this._dispHook("setClip",arguments)};core.elmProto.setSize=function(w,h){var oldW=this.getW();var oldH=this.getH();this.setW(w,true);this.setH(h,true);if(core.useElmHooks)this._dispHook("setSize",arguments);if(typeof this.onresize=="function")this.onresize(oldW,oldH,w,h)};core.elmProto.setSizeBy=function(w,h){this.setSize(this.getW()+parseInt(w),this.getH()+parseInt(h));this._dispHook("setSizeBy",arguments)};core.elmProto.moveTo=function(x,y){this.setPosition();var oldX=this.getX();var oldY=this.getY();this.setX(x,true);this.setY(y,true);if(core.useElmHooks)this._dispHook("moveTo",arguments);if(typeof this.onmove=="function")this.onmove(oldX,oldY,x,y)};core.elmProto.moveBy=function(x,y){this.moveTo(this.getX()+parseInt(x),this.getY()+parseInt(y));if(core.useElmHooks)this._dispHook("moveBy",arguments)};core.elmProto.moveToElm=function(e){this.moveTo(e.getX(),e.getY());if(core.useElmHooks)this._dispHook("moveToElm",arguments)};core.elmProto.setText=function(s){this.innerHTML=s;if(core.useElmHooks)this._dispHook("setText",arguments)};core.elmProto.hide=function(){this.style.visibility="hidden";if(core.useElmHooks)this._dispHook("hide",arguments)};core.elmProto.show=function(){this.style.visibility="visible";if(core.useElmHooks)this._dispHook("show",arguments)};core.elmProto.visible=function(){if(core.useElmHooks)this._dispHook("visible",arguments);return this.style.visibility=="visible"?true:false};core.elmProto.buttonDown=function(w){var d=this.theme?this.theme.bdrDark:core.themes.system.bdrDark;var h=this.theme?this.theme.bdrLight:core.themes.system.bdrLight;this.style.borderColor=d+" "+h+" "+h+" "+d;this.setB(core.rInt(w,this.theme?this.theme.bdrWidth:core.themes.system.bdrWidth));if(core.useElmHooks)this._dispHook("buttonDown",arguments)};core.elmProto.buttonUp=function(w){var d=this.theme?this.theme.bdrDark:core.themes.system.bdrDark;var h=this.theme?this.theme.bdrLight:core.themes.system.bdrLight;this.style.borderColor=h+" "+d+" "+d+" "+h;this.setB(core.rInt(w,this.theme?this.theme.bdrWidth:core.themes.system.bdrWidth));if(core.useElmHooks)this._dispHook("buttonUp",arguments)};core.elmProto.setClipBy=function(t,r,b,l){if(typeof(t)=="object"&&t.length){r=t[1];b=t[2];l=t[3];t=t[0]}var c=this.getClip();c[0]+=core.rInt(t);c[1]+=core.rInt(r);c[2]+=core.rInt(b);c[3]+=core.rInt(l);this.setClip(c);if(core.useElmHooks)this._dispHook("setClipBy",arguments)};core.elmProto.setAlpha=function(a){if(core.useElmHooks)this._dispHook("setAlpha",arguments);if(core.isMac&&core.isIE)return;if(!String(a).indexOf("%"))a=parseInt(a)*100;a=parseInt(a);if(a<0)a=0;if(a>100)a=100;if(core.isNS)this.style.setProperty("-moz-opacity",a/100,"");if(core.isIE)this.style.filter="alpha(opacity="+a+")"};core.elmProto.getAlpha=function(a){if(core.useElmHooks)this._dispHook("getAlpha",arguments);if(core.isMac&&core.isIE)return 100;if(core.isNS){var a=this.style.getPropertyValue("-moz-opacity");if(core.isNil(a))return 100;return parseInt(a*100)}if(core.isIE)return core.rInt(parseInt(this.style.filter.split("=")[1]),100)};core.elmProto.setPosition=function(p){p=core.rVal(p,"absolute");if(p!="fixed"&&!this.fixed)this.style.position=p;else if(p!="fixed"){core.fixedElms.deleteItem(this.fixedIndex);this.fixed=false;if(core.fixedElms.length==0){core.removeEvent(window,"scroll",core.fixElms);core.removeEvent(window,"resize",core.fixElms);core.fixElm=false}this.style.position=core.rVal(p,"absolute")}else if(!core.isIE){this.style.position="fixed"}else{if(!core.fixedElms)core.fixedElms=[];if(!core.fixElm){core.fixElms=function(){var elms=core.fixedElms;for(var a=0;a<elms.length;a++){elms[a].setY(core.scrollTop()+elms[a].fixedY);elms[a].setX(core.scrollLeft()+elms[a].fixedX)}};core.addEvent(window,"scroll",core.fixElms,true);core.addEvent(window,"resize",core.fixElms,true)}this.style.position="absolute";this.fixedX=this.getX();this.fixedY=this.getY();this.fixed=true;core.fixedElms[core.fixedElms.length]=this;this.fixedIndex=core.fixedElms.length-1}if(core.useElmHooks)this._dispHook("setPosition",arguments)};core.elmProto.remove=function(){var c=core.bags.elms;c.deleteItem(c.indexOf(this));var bag=core.bags[this.domAPIObjType.toLowerCase()];if(typeof bag!="undefined")bag.deleteItem(c.indexOf(this));if(core.groups){var g=this.inGroups();for(var i=0;i<g.length;i++)this.removeFromGroup(g[i])}var parent=this.parentNode;parent.removeChild(this)};core.elmProto.bringToFront=function(){this.setZ(core.rInt(this.parentNode._maxZ)+1)};core.elmProto.sendToBack=function(){this.setZ(core.rInt(this.parentNode._minZ)-1)};
